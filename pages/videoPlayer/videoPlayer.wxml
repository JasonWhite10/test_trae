<!-- pages/videoPlayer/videoPlayer.wxml -->
<view class="container" style="padding: 0; background-color: #000000; min-height: 100vh; transition: background-color 0.3s ease;">
  <!-- 视频播放器容器 - 支持横屏和全屏 -->
  <view class="video-player-wrapper" style="{{isFullScreen ? 'width: 100%; height: 100vh; position: fixed; top: 0; left: 0; z-index: 999; background-color: #000000;' : ''}}">
    <video
      id="myVideo"
      class="video-player"
      src="{{videoInfo.src}}"
      bindtimeupdate="onTimeUpdate"
      bindended="onEnded"
      binderror="onError"
      bindfullscreenchange="onFullscreenChange"
      bindwaiting="onWaiting"
      bindplay="onPlay"
      bindpause="onPause"
      show-center-play-btn="true"
      show-fullscreen-btn="true"
      show-play-btn="true"
      enable-progress-gesture="true"
      enable-play-gesture="true"
      controls="true"
      object-fit="contain"
    ></video>

    <!-- 视频加载中提示 -->
    <view wx:if="{{isLoading}}" class="loading-overlay">
      <view class="loading-spinner"></view>
      <text class="loading-text">加载中...</text>
    </view>

    <!-- 视频错误提示 -->
    <view wx:if="{{videoError}}" class="error-overlay">
      <view class="error-content">
        <image src="/images/shipin.png" class="error-icon"/>
        <text class="error-message">{{errorMsg}}</text>
        <button wx:if="{{showRetryOption}}" class="retry-btn" bindtap="retryPlay">重试</button>
        <view wx:else class="error-tips">请尝试返回上级页面，重新选择其他视频观看</view>
      </view>
    </view>
  </view>

  <!-- 非全屏模式下显示的视频信息 -->
  <view class="video-info" wx:if="{{!isFullScreen && !videoError && videoInfo}}" style="padding: 30rpx 20rpx; background-color: white;">
    <view class="video-title">{{videoInfo.title}}</view>
    <view class="video-meta">
      <text class="video-view-count">{{videoInfo.viewCount || 0}}次观看</text>
      <text class="video-duration">{{videoInfo.duration}}</text>
    </view>
    <view class="video-progress-section">
      <view class="progress-label">
        <text>观看进度: {{progress}}%</text>
        <text>{{formatTime(currentTime)}} / {{formatTime(duration)}}</text>
      </view>
      <view class="progress-bar">
        <view class="progress-value" style="width: {{progress}}%"></view>
        <view class="progress-thumb" style="left: {{progress}}%"></view>
      </view>
    </view>
  </view>
</view>